---
title: "Web開発でNode.jsのバージョンを固定する13の方法"
emoji: "🦒"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["nodejs", "npm", "pnpm", "開発環境"]
publication_name: "gigooo_blog"
published: true
---

## はじめに

みなさんは「自分のPCでは動くのに...」という経験はありませんか？
チーム開発をしていると、Node.jsやnpm/pnpmなどのバージョンが揃っていないことで思わぬトラブルに遭遇することがあります。
「npmのバージョンが古くてinstallを実行したらlockfileの形式が変わった...」「新しいNode.jsの機能が使えない」など、複数のプロジェクトで開発しているとバージョン不一致問題は厄介です。

この記事は、どのような方法でNode.jsとパッケージマネージャーのバージョンを固定できるのか調べた結果できあがったものです。

::: message
知っているもの+軽く調べたものまとめたため、不足しているものもありそうですが、その点についてはご容赦ください。
:::

ちなみに私は個人プロジェクトではdevEnginesあるいは、direnv + flake.nixをよく使います。
仕事ではdevEnginesあるいは、Voltaを提案することが多いです。ただ、自分で決められる現場であれば迷わず、direnv + Nix系の組み合わせを入れるでしょう。

## TL;DR

方法が多いので先に一覧です。

| ツール         | 設定ファイル                  | 特徴                                    |
|----------------|-------------------------------|-----------------------------------------|
| nvm            | `.nvmrc`                      | シェルスクリプト製、最も普及            |
| fnm            | `.nvmrc`, `.node-version`     | Rust製、高速、自動切り替え対応          |
| Volta          | `package.json`                | Rust製、package.jsonでバージョン固定    |
| mise           | `mise.toml`, `.tool-versions` | Rust製、多言語対応                      |
| proto          | `.prototools`                 | Rust製、WASM拡張対応                    |
| asdf           | `.tool-versions`              | Go製、プラグイン方式で多言語対応        |
| n              | `.node-version`               | シェルスクリプト製、npmで導入可能       |
| Corepack       | `package.json`                | Node.js同梱、パッケージマネージャー管理 |
| Dev Engines    | `package.json`                | Node.js 22+、ランタイム自動取得         |
| direnv + nvm   | `.envrc`                      | ディレクトリ移動で自動切り替え          |
| devenv         | `devenv.nix`                  | Nix基盤、宣言的な環境構築               |
| Docker         | `Dockerfile`                  | コンテナ分離、再現性が高い              |
| Dev Containers | `devcontainer.json`           | VSCode/IDE統合、開発環境の共有          |

## 分類

Node.jsのバージョンを固定する方法は、大きく4つのカテゴリに分類できます。

### バージョン管理ツール系

Node.jsのバージョンをインストール・切り替えするための専用ツールです。`.nvmrc`や`.node-version`といった設定ファイルでプロジェクトごとにバージョンを指定できます。

- nvm
- fnm
- volta
- mise
- proto
- asdf
- n

### パッケージマネージャー / Node.js組み込み系

`package.json`に設定を記述することで、パッケージマネージャーやNode.js自体がバージョンをチェック・管理します。

- Corepack
- Dev Engines

### 環境構築系

シェルの環境変数を管理するツールや、Nixを使った宣言的な環境構築ツールです。

- direnv + nvm
- direnv + Nix(Nix Flakes/devenv/devbox/shell.nix)

### コンテナ系

Dockerコンテナを使って、ランタイム環境ごと固定する方法です。

- Docker
- Dev Containers

---

## 各ツールの詳細

### 1. nvm（Node Version Manager）

最も広く使われていて、Neovimと見間違えるNode.jsバージョン管理ツールです。POSIX準拠のシェルスクリプトとして実装されており、macOSとLinuxで動作します。

https://github.com/nvm-sh/nvm

#### インストール

```bash
$ curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.40.3/install.sh | bash
```

#### 使い方

```bash
# Node.js 16に切り替え
$ nvm use 16
Now using node v16.9.1 (npm v7.21.1)

# バージョン確認
$ node -v
v16.9.1

# Node.js 14に切り替え
$ nvm use 14
Now using node v14.18.0 (npm v6.14.15)

# バージョン確認
$ node -v
v14.18.0

# Node.js 12をインストール
$ nvm install 12
Now using node v12.22.6 (npm v6.14.5)

# バージョン確認
$ node -v
v12.22.6
```

#### プロジェクトでのバージョン固定

プロジェクトルートに`.nvmrc`ファイルを作成します。

https://github.com/nvm-sh/nvm#nvmrc

```
20.10.0
```

このファイルがあるディレクトリで`nvm use`を実行すると、Node.js 20.10.0に切り替わります。

#### メリット

- メジャーで、情報が豊富
- シンプルで理解しやすい
- `.nvmrc`は他のツールでも認識される

#### デメリット

- macOS / Linuxのみ対応（Windowsネイティブは非対応、WSL経由なら可）

この記事を書いていて知りましたが、Windowsネイティブで動く[nvm-windows](https://github.com/coreybutler/nvm-windows)という別実装があるようです。

https://github.com/coreybutler/nvm-windows

---

### 2. fnm（Fast Node Manager）

知らべている中で知りました。
Rust製の高速なNode.jsバージョン管理ツールです。nvmと互換性があり、高速に動作します。
fnmはnvmと違い、Windows環境でも動作するようです。

https://github.com/Schniz/fnm

#### インストール

```bash
# macOS (Homebrew)
$ brew install fnm

# Linux / macOS (インストールスクリプト)
$ curl -fsSL https://fnm.vercel.app/install | bash

# Windows (winget)
$ winget install Schniz.fnm
```

#### シェルの設定

```bash
# .bashrc / .zshrc に追加
$ eval "$(fnm env --use-on-cd)"
```

`--use-on-cd`オプションにより、ディレクトリ移動時に自動でバージョンが切り替わります。

#### 使い方

```bash
# インストール
$ fnm install 20.10.0

# 切り替え
$ fnm use 20.10.0

# デフォルト設定
$ fnm default 20.10.0

# LTSバージョンのインストール
$ fnm install --lts
```

#### プロジェクトでのバージョン固定

`.nvmrc`または`.node-version`ファイルを使用します。

```
20.10.0
```

#### メリット

- Rust製で非常に高速
- クロスプラットフォーム（Windows / macOS / Linux）
- `.nvmrc`と`.node-version`の両方に対応
- ディレクトリ移動時の自動切り替えが標準機能

#### デメリット

- nvmより歴史が浅く、情報が少ない

---

### 3. Volta

JavaScriptツールチェーン全体を管理するツールです。Node.jsだけでなく、npm、yarn、pnpmなどのパッケージマネージャーや、グローバルにインストールしたCLIツールのバージョンも管理できます。

https://volta.sh

#### インストール

```bash
# macOS / Linux
$ curl https://get.volta.sh | bash

# Windows
$ winget install Volta.Volta
```

#### 使い方

```bash
# Node.jsのインストール
$ volta install node@20.10.0

# プロジェクトにNode.jsバージョンを固定
$ volta pin node@20.10.0

# パッケージマネージャーの固定
$ volta pin npm@10
$ volta pin yarn@4
```

#### プロジェクトでのバージョン固定

`volta pin`コマンドを実行すると、`package.json`に以下のように記録されます。

```json
{
  "volta": {
    "node": "20.10.0",
    "npm": "10.2.0"
  }
}
```

#### メリット

- `package.json`にバージョンが記録されるため、別途設定ファイルが不要
- ディレクトリ移動時の自動切り替えがデフォルトで有効
- グローバルツールのバージョンもプロジェクト単位で管理可能
- Rust製で高速

#### デメリット

- 設定方法が独自（`.nvmrc`非対応）
- pnpmのサポートは実験的
- `package.json`へ、Voltaを使っていない人には関係ないフィールドが追加される

---

### 4. mise（旧rtx）

Node.jsだけではなく、複数のプログラミング言語のランタイムを統一的に管理できるツールです。Python、Ruby、Goなど多くの言語に対応してます。

https://mise.jdx.dev

#### インストール

```bash
# macOS (Homebrew)
$ brew install mise

# Linux / macOS (インストールスクリプト)
$ curl https://mise.run | sh

# Windows
$ winget install jdx.mise
```

#### シェルの設定

```bash
# .bashrc / .zshrc に追加
$ eval "$(mise activate zsh)"  # または bash
```

#### 使い方

```bash
# Node.jsのインストール
$ mise install node@20.10.0

# グローバルに設定
$ mise use --global node@20.10.0

# プロジェクトに設定
$ mise use node@20.10.0
```

#### プロジェクトでのバージョン固定

`mise.toml`ファイルを使用します。

```toml
[tools]
node = "20.10.0"
```

または、asdf互換の`.tool-versions`ファイルも使用できます。

```
nodejs 20.10.0
```

さらに、`.nvmrc`や`.node-version`からの読み取りにも対応しています。

#### メリット

- 複数言語を1つのツールで管理可能
- Rust製で高速
- asdf、nvm、rbenvなどの設定ファイルと互換性がある
- 環境変数の管理機能もあり（direnvの代替になる）
- タスクランナー機能も内蔵

#### デメリット

- 旧名rtxからの名称変更で情報が分散している

---

### 5. proto

moonrepoが開発した、RustとWebAssemblyで構築された高速なマルチ言語バージョン管理ツールです。Node.js、Bun、Deno、Go、Python、Rubyなど多くの言語に対応しています。

https://moonrepo.dev/proto

#### インストール

```bash
# Linux / macOS / WSL
$ curl -fsSL https://moonrepo.dev/install/proto.sh | bash

# Windows (PowerShell)
$ irm https://moonrepo.dev/install/proto.ps1 | iex
```

デフォルトでは `~/.proto` にインストールされます。

#### シェルの設定

```bash
# .bashrc / .zshrc に追加
$ eval "$(proto activate bash)"  # または zsh
```

#### 使い方

```bash
# Node.jsのインストール
$ proto install node 20.10.0

# グローバルに設定
$ proto pin --global node 20.10.0

# プロジェクトに設定
$ proto pin node 20.10.0
```

#### プロジェクトでのバージョン固定

`.prototools`ファイルを使用します。

```toml
node = "20.10.0"
npm = "10"
pnpm = "9"
```

エイリアスを定義することもできます。

```toml
[tools.node]
bundled-npm = true

[tools.node.aliases]
work = "18"
oss = "20"
```

#### メリット

- RustとWebAssemblyで構築されており高速
- 単一のCLIで複数言語のバージョン管理が可能
- クロスプラットフォーム対応（Windows / macOS / Linux）
- チェックサム検証によるセキュリティ
- 800以上のasdfプラグインにも対応

#### デメリット

- 比較的新しいツールのため、情報が少ない
- miseやasdfと比較すると知名度が低い

---

### 6. asdf

プラグイン方式で多くの言語・ツールに対応するバージョン管理ツールです。v0.16からGo言語で書き直され、パフォーマンスが向上しました。

https://asdf-vm.com

#### インストール

```bash
# Homebrew
$ brew install asdf

# Git
$ git clone https://github.com/asdf-vm/asdf.git ~/.asdf --branch v0.16.0
```

#### 使い方

```bash
# Node.jsプラグインの追加
$ asdf plugin add nodejs

# インストール
$ asdf install nodejs 20.10.0

# グローバルに設定
$ asdf set --home nodejs 20.10.0

# プロジェクトに設定
$ asdf set nodejs 20.10.0
```

#### プロジェクトでのバージョン固定

`.tool-versions`ファイルを使用します。

```
nodejs 20.10.0
```

`.nvmrc`や`.node-version`を読み取るには、`~/.asdfrc`に以下を追加します。

```
legacy_version_file = yes
```

#### メリット

- 1つのツールで多くの言語・ツールを管理可能
- プラグインエコシステムが充実
- `.tool-versions`で複数ツールのバージョンを一元管理

#### デメリット

- macOS / Linuxのみ対応（Windowsネイティブは非対応、WSL経由なら可）
- プラグインの追加が必要
- miseと比較するとやや遅い

---

### 7. n

TJが開発したシンプルなNode.jsバージョン管理ツールです。npmでインストールできるため、既存のNode.js環境があればすぐに導入できます。

https://github.com/tj/n

#### インストール

```bash
# npm経由
$ npm install -g n

# Homebrew
$ brew install n

# インストールスクリプト
$ curl -L https://bit.ly/n-install | bash
```

#### 使い方

```bash
# 特定バージョンのインストール
$ n 20.10.0

# LTSバージョンのインストール
$ n lts

# 最新バージョンのインストール
$ n latest

# インタラクティブに選択
$ n
```

#### プロジェクトでのバージョン固定

`.node-version`または`.n-node-version`ファイルを使用します。

```
20.10.0
```

`n auto`コマンドで、設定ファイルに基づいてバージョンを切り替えます。また、`package.json`の`engines`フィールドを読み取る`n engine`コマンドもあります。

#### メリット

- シンプルで使いやすい
- npmでインストール可能
- インタラクティブなバージョン選択UI

#### デメリット

- macOS / Linuxのみ対応（Windowsネイティブは非対応、WSL経由なら可）
- グローバルにNode.jsをインストールするため、権限の設定が必要な場合がある

---

### 8. Corepack

Node.js 14.19以降に同梱されているパッケージマネージャー管理ツールです。yarn、pnpm、npmのバージョンを`package.json`で固定できます。

https://github.com/nodejs/corepack

https://nodejs.org/api/corepack.html

#### 有効化

Corepackはデフォルトで無効になっているため、有効化が必要です。

```bash
# 例
$ corepack enable
```

#### プロジェクトでのバージョン固定

`package.json`に`packageManager`フィールドを追加します。

```json
{
  "packageManager": "pnpm@9.1.4"
}
```

または、コマンドで設定することもできます。

```bash
$ corepack use pnpm@9.1.4
```

#### 動作

`packageManager`が設定されているプロジェクトで異なるパッケージマネージャーを使おうとすると、エラーが発生します。また、指定されたバージョンのパッケージマネージャーが自動的にダウンロードされて使用されます。

#### メリット

- Node.jsに同梱されており、追加インストール不要
- チーム全員が同じパッケージマネージャーのバージョンを使うことを強制できる
- `package.json`に記録されるため、設定の共有が容易

#### デメリット

- 実験的機能のため、明示的な有効化が必要
- Node.jsのバージョン管理は別途必要
- npmのshimはデフォルトで作成されない

公式ドキュメントの根拠:
> "While Corepack could support npm like any other package manager, its shims aren't enabled by default."
https://nodejs.org/download/release/v22.13.1/docs/api/corepack.html

注意: Node.js 25からはCorepackが同梱されなくなる予定です。

---

### 9. Dev Engines

`package.json`の`devEngines`フィールドを使って、開発環境で使用するランタイムやパッケージマネージャーを指定する新しい仕様です。pnpm 10.14以降でサポートされ、npmでもサポートされています。

https://pnpm.io/package_json

https://docs.npmjs.com/cli/v11/configuring-npm/package-json

#### プロジェクトでのバージョン固定

```json
{
  "devEngines": {
    "runtime": {
      "name": "node",
      "version": "^20.0.0",
      "onFail": "download"
    },
    "packageManager": {
      "name": "pnpm",
      "version": ">=9"
    }
  }
}
```

pnpmでは`onFail: "download"`を指定することで、指定されたバージョンのNode.jsが自動的にダウンロードされます。

#### メリット

- `package.json`に記録されるため、設定の共有が容易
- ランタイムとパッケージマネージャーの両方を指定可能
- semver範囲で柔軟に指定できる

#### デメリット

- 比較的新しい仕様のため、対応ツールが限られる
- `engines`フィールドとの使い分けが混乱しやすい

---

### 10. direnv + nvm

direnvは、Node.jsonのバージョンを管理できるツールではなく、ディレクトリごとに環境変数を自動で切り替えるツールです。nvmと組み合わせることで、プロジェクトディレクトリに入ると自動的にNode.jsのバージョンが切り替わるようになります。

https://direnv.net
https://github.com/direnv/direnv

#### インストール

```bash
# Homebrew
$ brew install direnv

# apt
$ sudo apt install direnv
```

#### シェルの設定

```bash
# .bashrc / .zshrc に追加
$ eval "$(direnv hook bash)"  # または zsh
```

#### プロジェクトでの設定

プロジェクトルートに`.envrc`ファイルを作成します。

```bash
# .envrc
$ source ~/.nvm/nvm.sh
$ nvm use
```

初回は`direnv allow`で許可が必要です。

```bash
$ direnv allow
```

#### メリット

- ディレクトリ移動時の自動切り替えが可能
- Node.js以外の環境変数も管理できる
- 様々なツールと組み合わせ可能

#### デメリット

- 設定がやや複雑
- `.envrc`のセキュリティ承認が必要

---

### 11. devenv / Nix Flakes / devbox / shell.nix

Nixパッケージマネージャーを使った宣言的な開発環境構築ツールです。

https://devenv.sh

https://wiki.nixos.org/wiki/Flakes/ja

https://www.jetify.com/devbox

https://nix.dev/tutorials/first-steps/declarative-shell.html

#### インストール

```bash
# Nixがインストールされている場合
$ nix-env -iA devenv -f https://github.com/NixOS/nixpkgs/tarball/nixpkgs-unstable
```

#### プロジェクトでの設定

ツール毎のドキュメントを確認してください。

#### 使い方

ツール毎のドキュメントを確認してください。

#### メリット

- 完全に再現可能な開発環境
- Node.js以外のツール（データベース、言語など）も同時に管理可能
- チーム全員が完全に同じ環境を使える
- direnvと連携して自動的に環境を有効化できる

#### デメリット

- Nixの学習コストが高い
- 初回のビルドに時間がかかる
- Windowsでの利用は制限がある（WSL経由）

---

### 12. Docker

Dockerコンテナを使ってNode.jsの実行環境ごと固定する方法です。開発環境だけでなく、本番環境との一貫性も保てます。

https://hub.docker.com/_/node

#### Dockerfile例

```dockerfile
FROM node:20.10.0-alpine

WORKDIR /app

COPY package*.json ./
RUN npm ci

COPY . .

CMD ["npm", "start"]
```

#### docker-compose.yml例

```yaml
version: '3.8'
services:
  app:
    build: .
    volumes:
      - .:/app
      - /app/node_modules
    ports:
      - "3000:3000"
```

#### メリット

- 開発・本番環境の完全な一貫性
- Node.js以外の依存（データベースなど）も含めて管理可能
- OSレベルでの環境分離

#### デメリット

- Dockerの知識が必要
- ホストマシンとのファイル同期にオーバーヘッドがある
- macOSでのパフォーマンス問題がある場合がある

---

### 13. Dev Containers

VS CodeのDev Containers拡張機能を使って、Dockerコンテナ内で開発を行う方法です。コンテナ内にVS Codeのサーバーが起動し、ローカルのVS Codeからシームレスに開発できます。

https://code.visualstudio.com/docs/devcontainers/create-dev-container

#### 設定ファイル

`.devcontainer/devcontainer.json`を作成します。

```json
{
  "name": "Node.js Development",
  "image": "mcr.microsoft.com/devcontainers/javascript-node:20",
  "features": {
    "ghcr.io/devcontainers/features/node:1": {
      "version": "20"
    }
  },
  "customizations": {
    "vscode": {
      "extensions": [
        "dbaeumer.vscode-eslint",
        "esbenp.prettier-vscode"
      ]
    }
  },
  "postCreateCommand": "npm install",
  "forwardPorts": [3000]
}
```

#### 使い方

1. VS Codeで「Dev Containers: Reopen in Container」コマンドを実行
2. コンテナがビルドされ、VS Codeがコンテナに接続
3. コンテナ内で開発を開始

#### メリット

- 設定ファイルをリポジトリにコミットすることで、チーム全員が同じ環境を使える
- VS Codeの拡張機能もコンテナ内にインストールされる
- Dockerの知識が少なくても使いやすい

#### デメリット

- VS Code（またはDev Containers対応エディタ）が必要
- 初回起動に時間がかかる
- リソース消費が大きい

---


## まとめ

Node.jsのバージョンを固定する方法は多岐にわたりますが、それぞれに特徴があります。

2026年現在、新規プロジェクトで特にこだわりがなければ、Voltaあるいはmiseあたりから始めるのが良いでしょう。

チーム開発では、選んだツールを`README.md`に明記し、可能であれば設定ファイル（`.nvmrc`など）をリポジトリにコミットしましょう。これにより、新しいメンバーが参加しても、スムーズに開発を始められます。

口伝での環境構築ではなく、皆が手間をかけず意識することなく統一された開発環境を提供できるようにレポジトリは整えましょう。

---

## 参考リンク
https://github.com/nvm-sh/nvm
https://github.com/Schniz/fnm
https://volta.sh
https://mise.jdx.dev
https://moonrepo.dev/proto
https://asdf-vm.com
https://github.com/tj/n
https://nodejs.org/api/corepack.html
https://pnpm.io/package_json
https://direnv.net
https://devenv.sh
https://code.visualstudio.com/docs/devcontainers/create-dev-container
